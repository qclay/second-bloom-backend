<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Second Bloom — Test App</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div id="app">
    <section id="login-screen" class="screen">
      <div class="card login-card">
        <h1 data-i18n="login_title">Second Bloom</h1>
        <p class="muted" data-i18n="login_subtitle">Sign in to test the platform</p>

        <div id="login-step-send" class="step">
          <label data-i18n="country_code">Country code</label>
          <input type="text" id="country-code" value="+998" placeholder="+998" maxlength="5" />
          <label data-i18n="phone_number">Phone number</label>
          <input type="text" id="phone-number" placeholder="901234567" />
          <button type="button" id="btn-send-otp" class="btn primary" data-i18n="send_otp">Send OTP</button>
        </div>

        <div id="login-step-verify" class="step hidden">
          <p><span data-i18n="code_sent_to">Code sent to</span> <strong id="verify-phone"></strong></p>
          <label data-i18n="verify_code_label">Verification code (6 digits)</label>
          <input type="text" id="otp-code" placeholder="123456" maxlength="6" />
          <button type="button" id="btn-verify" class="btn primary" data-i18n="verify_signin">Verify &amp; Sign In</button>
          <button type="button" id="btn-back-otp" class="btn secondary" data-i18n="change_number">Change number</button>
        </div>

        <div id="login-error" class="error hidden"></div>
      </div>
    </section>

    <section id="main-app" class="hidden">
      <header id="top-bar">
        <div class="top-bar-left">
          <h1 class="logo">Second Bloom</h1>
        </div>
        <div class="top-bar-right">
          <select id="lang-switcher" title="Language">
            <option value="en">English</option>
            <option value="uz">O'zbekcha</option>
            <option value="ru">Русский</option>
          </select>
          <button type="button" id="btn-notifications-bell" class="icon-btn" title="Notifications">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
            <span id="notif-badge" class="badge hidden">0</span>
          </button>
          <span class="user-info"><span data-i18n="signed_in_as">Signed in as</span> <strong id="user-display-name"></strong></span>
          <button type="button" id="btn-logout" class="btn secondary small" data-i18n="logout">Logout</button>
        </div>
      </header>

      <nav id="tab-nav">
        <button class="tab-btn active" data-tab="products" data-i18n="tab_products">Products</button>
        <button class="tab-btn" data-tab="auctions" data-i18n="tab_auctions">Auctions</button>
        <button class="tab-btn" data-tab="chat" data-i18n="tab_chat">Chat</button>
        <button class="tab-btn" data-tab="notifications" data-i18n="tab_notifications">Notifications</button>
      </nav>

      <div class="tab-panels">

        <div id="panel-products" class="tab-panel active">
          <div id="products-list-view">
            <div class="panel-header">
              <h2 data-i18n="tab_products">Products</h2>
              <div class="panel-actions">
                <input type="text" id="product-search-input" data-i18n-placeholder="search_products" placeholder="Search products..." />
                <button type="button" id="btn-create-product" class="btn primary small" data-i18n="create_product">+ Create Product</button>
              </div>
            </div>
            <div id="products-grid" class="card-grid"></div>
            <div id="products-empty" class="empty-state hidden" data-i18n="no_products">No products found</div>
            <div id="products-loading" class="loading-state hidden" data-i18n="loading">Loading...</div>
            <div class="pagination">
              <button type="button" id="products-prev" class="btn secondary small" disabled>&laquo; Prev</button>
              <span id="products-page-info">Page 1</span>
              <button type="button" id="products-next" class="btn secondary small" disabled>Next &raquo;</button>
            </div>
          </div>

          <div id="product-detail-view" class="detail-view hidden">
            <button type="button" class="btn secondary small btn-back" data-i18n="back">&larr; Back</button>
            <div id="product-detail-content"></div>
          </div>

          <div id="product-create-view" class="form-view hidden">
            <button type="button" class="btn secondary small btn-back" data-i18n="back">&larr; Back</button>
            <h3 data-i18n="create_product">Create Product</h3>
            <form id="product-create-form" class="form">
              <div class="form-group">
                <label data-i18n="product_title">Title</label>
                <input type="text" id="pc-title" required />
              </div>
              <div class="form-group">
                <label data-i18n="product_description">Description</label>
                <textarea id="pc-description" rows="3"></textarea>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label data-i18n="product_price">Price</label>
                  <input type="number" id="pc-price" step="0.01" />
                </div>
                <div class="form-group">
                  <label data-i18n="product_currency">Currency</label>
                  <select id="pc-currency">
                    <option value="UZS">UZS</option>
                    <option value="USD">USD</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label data-i18n="product_category">Category</label>
                  <select id="pc-category" required><option value="">Loading...</option></select>
                </div>
                <div class="form-group">
                  <label data-i18n="product_condition">Condition</label>
                  <select id="pc-condition" required><option value="">Loading...</option></select>
                </div>
                <div class="form-group">
                  <label data-i18n="product_size">Size</label>
                  <select id="pc-size" required><option value="">Loading...</option></select>
                </div>
              </div>
              <div class="form-group">
                <label data-i18n="product_tags">Tags (comma-separated)</label>
                <input type="text" id="pc-tags" placeholder="roses, fresh, gift" />
              </div>
              <div class="form-group">
                <label data-i18n="product_region">Region / City</label>
                <div class="form-row">
                  <input type="text" id="pc-region" placeholder="Region" />
                  <input type="text" id="pc-city" placeholder="City" />
                </div>
              </div>

              <div class="form-group checkbox-group">
                <label>
                  <input type="checkbox" id="pc-create-auction" />
                  <span data-i18n="product_create_auction">Create with auction</span>
                </label>
              </div>
              <div id="auction-fields" class="hidden">
                <div class="form-row">
                  <div class="form-group">
                    <label data-i18n="auction_start_price">Start price</label>
                    <input type="number" id="pc-auction-start-price" step="0.01" />
                  </div>
                  <div class="form-group">
                    <label data-i18n="auction_duration">Duration (hours)</label>
                    <input type="number" id="pc-auction-duration" value="2" min="1" max="168" />
                  </div>
                </div>
                <div class="form-group checkbox-group">
                  <label>
                    <input type="checkbox" id="pc-auction-auto-extend" checked />
                    <span data-i18n="auction_auto_extend">Auto-extend on late bids</span>
                  </label>
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn primary" data-i18n="save">Save</button>
                <button type="button" id="btn-cancel-create-product" class="btn secondary" data-i18n="cancel">Cancel</button>
              </div>
            </form>
          </div>

          <div id="product-edit-view" class="form-view hidden">
            <button type="button" class="btn secondary small btn-back" data-i18n="back">&larr; Back</button>
            <h3 data-i18n="edit_product">Edit Product</h3>
            <form id="product-edit-form" class="form">
              <input type="hidden" id="pe-product-id" />
              <div id="product-edit-images" class="form-group product-edit-images"></div>
              <div class="form-group">
                <label data-i18n="product_title">Title</label>
                <input type="text" id="pe-title" required />
              </div>
              <div class="form-group">
                <label data-i18n="product_description">Description</label>
                <textarea id="pe-description" rows="3"></textarea>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label data-i18n="product_price">Price</label>
                  <input type="number" id="pe-price" step="0.01" />
                </div>
                <div class="form-group">
                  <label data-i18n="product_currency">Currency</label>
                  <select id="pe-currency">
                    <option value="UZS">UZS</option>
                    <option value="USD">USD</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label data-i18n="product_category">Category</label>
                  <select id="pe-category" required><option value="">Loading...</option></select>
                </div>
                <div class="form-group">
                  <label data-i18n="product_condition">Condition</label>
                  <select id="pe-condition" required><option value="">Loading...</option></select>
                </div>
                <div class="form-group">
                  <label data-i18n="product_size">Size</label>
                  <select id="pe-size" required><option value="">Loading...</option></select>
                </div>
              </div>
              <div class="form-group">
                <label data-i18n="product_tags">Tags (comma-separated)</label>
                <input type="text" id="pe-tags" placeholder="roses, fresh, gift" />
              </div>
              <div class="form-group">
                <label data-i18n="product_region">Region / City</label>
                <div class="form-row">
                  <input type="text" id="pe-region" placeholder="Region" />
                  <input type="text" id="pe-city" placeholder="City" />
                </div>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn primary" data-i18n="save">Save</button>
                <button type="button" id="btn-cancel-edit-product" class="btn secondary" data-i18n="cancel">Cancel</button>
              </div>
            </form>
          </div>
        </div>

        <div id="panel-auctions" class="tab-panel">
          <div id="auctions-list-view">
            <div class="panel-header">
              <h2 data-i18n="tab_auctions">Auctions</h2>
              <div class="panel-actions">
                <select id="auction-status-filter">
                  <option value="" data-i18n="all">All</option>
                  <option value="ACTIVE" data-i18n="active">Active</option>
                  <option value="ENDED" data-i18n="ended">Ended</option>
                </select>
                <button type="button" id="btn-refresh-auctions" class="btn secondary small" data-i18n="refresh">Refresh</button>
              </div>
            </div>
            <div id="auctions-grid" class="card-grid"></div>
            <div id="auctions-empty" class="empty-state hidden" data-i18n="no_auctions">No auctions found</div>
            <div id="auctions-loading" class="loading-state hidden" data-i18n="loading">Loading...</div>
            <div class="pagination">
              <button type="button" id="auctions-prev" class="btn secondary small" disabled>&laquo; Prev</button>
              <span id="auctions-page-info">Page 1</span>
              <button type="button" id="auctions-next" class="btn secondary small" disabled>Next &raquo;</button>
            </div>
          </div>

          <div id="auction-detail-view" class="detail-view hidden">
            <button type="button" class="btn secondary small btn-back" data-i18n="back">&larr; Back</button>
            <div id="auction-detail-content"></div>
          </div>
        </div>

        <div id="panel-chat" class="tab-panel">
          <div class="chat-layout">
            <aside class="sidebar">
              <div class="sidebar-header">
                <h2 data-i18n="conversations">Conversations</h2>
                <button type="button" id="btn-new-chat" class="btn primary small" data-i18n="new_chat">New Chat</button>
              </div>
              <div id="new-chat-form" class="new-chat-form hidden">
                <p class="new-chat-title" data-i18n="start_chat_with_user">Start a chat with a user</p>
                <input type="text" id="new-chat-search" data-i18n-placeholder="search_by_name" placeholder="Search by name or phone..." autocomplete="off" />
                <div id="user-list" class="user-list"></div>
                <input type="text" id="new-chat-message" data-i18n-placeholder="first_message_optional" placeholder="First message (optional)" class="mt" />
                <div class="row">
                  <button type="button" id="btn-cancel-new-chat" class="btn secondary small" data-i18n="cancel">Cancel</button>
                </div>
              </div>
              <ul id="conversation-list" class="conversation-list"></ul>
              <div id="conversation-list-empty" class="empty-state hidden" data-i18n="no_conversations">No conversations yet</div>
            </aside>

            <main class="chat-main">
              <div id="no-conversation" class="empty-state select-conversation">
                <p data-i18n="select_conversation">Select a conversation or start a new chat.</p>
              </div>
              <div id="conversation-view" class="conversation-view hidden">
                <div class="conversation-header">
                  <div class="conv-header-left">
                    <h3 id="conversation-title">Chat</h3>
                    <span id="conversation-status" class="conversation-status offline" data-i18n="offline">Offline</span>
                  </div>
                  <span id="ws-status" class="ws-status">--</span>
                </div>
                <div id="messages-container" class="messages-container">
                  <div id="messages-list" class="messages-list"></div>
                </div>
                <div id="typing-indicator" class="typing-indicator hidden" data-i18n="someone_typing">Someone is typing...</div>
                <form id="message-form" class="message-form">
                  <input type="text" id="message-input" data-i18n-placeholder="type_message" placeholder="Type a message..." autocomplete="off" />
                  <button type="submit" id="btn-send-message" class="btn primary" data-i18n="send">Send</button>
                </form>
              </div>
            </main>
          </div>
        </div>

        <div id="panel-notifications" class="tab-panel">
          <div class="panel-header">
            <h2 data-i18n="tab_notifications">Notifications</h2>
            <div class="panel-actions">
              <button type="button" id="btn-mark-all-read" class="btn secondary small" data-i18n="mark_all_read">Mark all read</button>
              <button type="button" id="btn-refresh-notifications" class="btn secondary small" data-i18n="refresh">Refresh</button>
            </div>
          </div>
          <div id="notif-filter-bar" class="filter-bar">
            <button class="filter-btn active" data-filter="all" data-i18n="all">All</button>
            <button class="filter-btn" data-filter="unread" data-i18n="unread">Unread</button>
          </div>
          <div id="notifications-list" class="notifications-list"></div>
          <div id="notifications-empty" class="empty-state hidden">
            <div class="notif-empty-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/><line x1="1" y1="1" x2="23" y2="23" stroke-dasharray="2 2"/></svg></div>
            <p data-i18n="no_notifications">No notifications yet</p>
          </div>
          <div id="notifications-loading" class="loading-state hidden" data-i18n="loading">Loading...</div>
        </div>

      </div>
    </section>
  </div>

  <div id="event-log-panel" class="event-log-panel collapsed">
    <div id="event-log-header" class="event-log-header">
      <span><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg> Socket Events</span>
      <div style="display:flex;align-items:center;gap:.5rem">
        <span id="event-log-count" class="event-log-count">0</span>
        <button type="button" id="btn-clear-log" class="btn secondary small" style="padding:.2rem .5rem;font-size:.7rem">Clear</button>
        <button type="button" id="btn-toggle-log" class="btn secondary small" style="padding:.2rem .5rem;font-size:.7rem">Expand</button>
      </div>
    </div>
    <div id="event-log-body" class="event-log-body">
      <div id="event-log-list" class="event-log-list"></div>
    </div>
  </div>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
